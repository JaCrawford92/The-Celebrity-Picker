{% extends 'celebritypicker/base.html' %}
{% load static %}
{% block content %}
<div class="max-w-4xl mx-auto px-4 py-6">
    <h1 class="text-2xl font-bold mb-4">Your Profile</h1>
    {% if profile.photo %}
        <img src="{{ profile.photo.url }}" alt="Profile Photo" class="w-24 h-24 rounded-full mb-4">
    {% else %}
        <img src="{% static 'images/default-profile.png' %}" alt="Default Profile Photo" class="w-24 h-24 rounded-full mb-4">
    {% endif %}
    <a href="{% url 'update_profile' %}" class="btn btn-primary">Update Profile</a>
    <h2 class="text-xl font-semibold mt-6">Random Picks History</h2>
    <ul>
        {% for pick in random_picks %}
        <li>{{ pick.title }} - {{ pick.created_at }}</li>
        {{ pick.overview }}
        {% if pick.poster_path %}
            <img src="https://image.tmdb.org/t/p/w200{{ pick.poster_path }}" alt="{{ pick.title }}">
        {% endif %}
        <button class="btn btn-danger mt-4" onclick="deletePick({{ pick.id }})">Delete</button>
        {% endfor %}
    </ul>
</div>
<script>
    function deletePick(pickId) {
        if (confirm('Are you sure you want to delete this pick?')) {
            fetch("{% url 'delete_pick' 0 %}".replace('0', pickId), {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    location.reload();
                } else {
                    alert('Error: ' + data.message);
                }
            });
        }
    }
</script>
{% endblock %}

